<?xml version="1.0" encoding="utf-8"?>

<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:SchnapsSchuss.ViewModels"
             x:Class="SchnapsSchuss.Views.AddPersonPage">

    <ContentPage.BindingContext>
        <vm:AddPersonPageViewModel />
    </ContentPage.BindingContext>

    <VerticalStackLayout Margin="10">
        <FlexLayout JustifyContent="SpaceBetween" Margin="5,20,5,20">
            <Label Text="Person auswählen" FontSize="Large" VerticalOptions="Center"/>
            <HorizontalStackLayout Spacing="10">
                <Label Text="Suchen" VerticalTextAlignment="Center" FontSize="20"/>
                <Entry x:Name="SearchInput" Placeholder="Suche nach Mitgliedern" MinimumWidthRequest="500" Text="{Binding SearchText}" />
            </HorizontalStackLayout>
            <Button Text="Gast Hinzufügen" Command="{Binding AddGuestCommand}" />
        </FlexLayout>
        
        <!-- Header Row --> 
        <Border Style="{StaticResource RowHeader}" Margin="0,0,0,5" >
            <Grid ColumnDefinitions="2*,2*,2*,1*" Padding="10" >
                <Label Grid.Column="0" Text="Nachname" FontAttributes="Bold" FontSize="20" />
                <Label Grid.Column="1" Text="Vorname" FontAttributes="Bold" FontSize="20" />
                <Label Grid.Column="2" Text="Geburtsdatum" FontAttributes="Bold" FontSize="20" />
                <Label Grid.Column="3" Text="Hat Waffenbesitzkarte" FontAttributes="Bold" FontSize="20" />
            </Grid>
        </Border>
        <ScrollView VerticalOptions="Fill" HorizontalOptions="Fill">
            <!-- Personenliste -->
            <CollectionView ItemsSource="{Binding FilteredPersons}"
                        SelectionMode="Single"
                        SelectedItem="{Binding SelectedPerson, Mode=TwoWay}">
                <CollectionView.ItemsLayout>
                    <LinearItemsLayout
                        Orientation="Vertical"
                        ItemSpacing="5"/>
                </CollectionView.ItemsLayout>
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Border Style="{StaticResource RowEntry}">
                            <Grid ColumnDefinitions="2*,2*,2*,1*"  >
                                <Label Grid.Column="0" 
                                       Text="{Binding LastName}" 
                                       VerticalTextAlignment="Center" 
                                       FontSize="20" />
                                <Label Grid.Column="1" 
                                       Text="{Binding FirstName}" 
                                       FontSize="20" />
                                <Label Grid.Column="2"
                                       Text="{Binding DateOfBirth}"
                                       FontSize="20" />
                                <Label Grid.Column="3"
                                       Text="{Binding OwnsGunOwnershipCard}"
                                       FontSize="20" />
                            </Grid>
                        </Border>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
        </ScrollView>
    </VerticalStackLayout>
    

</ContentPage>